chrome.runtime.onMessage.addListener((e,s,t)=>{if("getSfHost"!=e.message)return"getSession"==e.message&&(sfHost=e.sfHost,chrome.cookies.get({url:"https://"+e.sfHost,name:"sid",storeId:s.tab.cookieStoreId},e=>{e?(e={key:e.value,hostname:e.domain},t(e)):t(null)}),!0);{const o=new URL(e.url).hostname;return chrome.cookies.get({url:e.url,name:"sid",storeId:s.tab.cookieStoreId},e=>{if(!e||o.endsWith(".mcas.ms"))t(o);else{let[o]=e.value.split("!");["salesforce.com","cloudforce.com","salesforce.mil","cloudforce.mil","sfcrmproducts.cn"].forEach(e=>{chrome.cookies.getAll({name:"sid",domain:e,secure:!0,storeId:s.tab.cookieStoreId},e=>{e=e.find(e=>e.value.startsWith(o+"!"));e&&t(e.domain)})})}}),!0}});